!function(){!function(e,a){define(["base","datatables","tree","cookies"],function(e){var a=10,t={loginStatus:!1,loginTimeEntity:null,loginTime:18e5,isEn:!1,hasRole:!0,menuEnData:[{label:"首页概览",labelEN:"Home"},{label:"注册管理",labelEN:"Register"},{label:"请求方注册",labelEN:"Request"},{label:"服务方注册",labelEN:"Service"},{label:"审批管理",labelEN:"Approval"},{label:"请求方审批",labelEN:"Request"},{label:"服务方审批",labelEN:"Service"},{label:"资源申请审批",labelEN:"Resource application"},{label:"资源管理",labelEN:"Resource"},{label:"资源编目",labelEN:"Directory"},{label:"资源申请",labelEN:"Application"},{label:"我申请的资源",labelEN:"My resource"},{label:"元数据管理",labelEN:"Metadata"},{label:"目录分类",labelEN:"Classify"},{label:"字典管理",labelEN:"Dictionary"},{label:"数据元管理",labelEN:"Metadata"},{label:"单位管理",labelEN:"Unit"},{label:"数据源管理",labelEN:"DataSource"},{label:"日志审计",labelEN:"Log audit"},{label:"操作日志",labelEN:"Operate"},{label:"服务日志",labelEN:"Service"},{label:"业务分析",labelEN:"Analysis"},{label:"实时分析",labelEN:"Real-time"},{label:"请求方分析",labelEN:"Request"},{label:"服务方分析",labelEN:"Service"},{label:"用户管理",labelEN:"User"},{label:"用户管理",labelEN:"User"},{label:"角色管理",labelEN:"Role"},{label:"系统管理",labelEN:"System"},{label:"消息管理",labelEN:"Message"},{label:"设备管理",labelEN:"Device"},{label:"NTP配置",labelEN:"NTP"},{label:"端口转发",labelEN:"Port"},{label:"黑名单管理",labelEN:"Blacklist"},{label:"白名单管理",labelEN:"Whitelist"}],mergeMenuData:function(e){for(var a=0,n=e.length;a<n;a++)for(var l=0,r=t.menuEnData.length;l<r;l++)e[a].label==t.menuEnData[l].label&&(e[a].labelEN=t.menuEnData[l].labelEN)},setInternationalization:function(){t.isEn&&$("[en]").each(function(e,a){$(a).html($(a).attr("en"))})},setLoginTimeout:function(){t.loginTimeEntity&&window.clearTimeout(t.loginTimeEntity),t.loginStatus=!0,t.loginTimeEntity=window.setTimeout(function(){t.loginStatus=!1,t.login()},t.loginTime)},init:function(){var a={};return $(".btn").attr("onclick","return false"),$(".btn.back,.btn.cancel").on("click",function(){t.back()}),$(".ui-content-aside").not(".mCustomScrollbar").length>0&&(a.scroll=e.scroll({container:$(".ui-content-aside").not(".mCustomScrollbar")})),a.date=e.form.date({element:$(".ui-form-date"),range:!0,theme:"#0387db"}),a},getUserInfo:function(){var e=t.getCookies();return e||(window.location.href=$.base+"/login.html"),e},contentScroll:function(){$(".ui-content-aside").not(".mCustomScrollbar").length>0&&e.scroll({container:$(".ui-content-aside").not(".mCustomScrollbar")})},refresh:function(e){e.refresh()},search:function(e){e.reload()},reset:function(a,t){e.form.reset(a,function(){t&&t.reload()})},setResetForm:function(a){$(a).unbind("click").on("click",function(){e.form.reset($(this).parents(".ui-content").find("form")[0])})},setSubmitForm:function(a,t,n){$(a).unbind("click").on("click",function(){e.form.validate({form:$(n).length>0?$(n):$(this).parents(".ui-content").find("form")[0],checkAll:!0,passCallback:function(){t&&t()}})})},checkByGridButton:function(e){if(e&&e.length>0){var a=$(e).filter(":checked");1==a.length?($(".ui-grid-buttonbar .modify").removeClass("disabled"),$(".ui-grid-buttonbar .delete").removeClass("disabled"),$(".ui-grid-buttonbar .add").addClass("disabled"),$(".ui-grid-buttonbar .adds").removeClass("disabled")):a.length>1?($(".ui-grid-buttonbar .modify").removeClass("disabled"),$(".ui-grid-buttonbar .modify").addClass("disabled"),$(".ui-grid-buttonbar .delete").removeClass("disabled"),$(".ui-grid-buttonbar .add").addClass("disabled"),$(".ui-grid-buttonbar .adds").addClass("disabled")):($(".ui-grid-buttonbar .add").removeClass("disabled"),$(".ui-grid-buttonbar .modify").removeClass("disabled"),$(".ui-grid-buttonbar .modify").addClass("disabled"),$(".ui-grid-buttonbar .delete").removeClass("disabled"),$(".ui-grid-buttonbar .delete").addClass("disabled"),$(".ui-grid-buttonbar .adds").removeClass("disabled"))}},submit:function(a){var t=a.url?a.url:"",n=a.params?a.params:null,l=a.type?a.type:"get",r=a.callback?a.callback:null,i=(a.position?a.position:"top",e.requestTip({position:"center"})),o=0!=a.async;t&&e.ajax({url:t,params:n,type:l,async:o,timeout:1e4,success:function(e){return e.success?(i.success("提交成功！"),void(r&&r(e))):void i.error(e.message)},beforeSend:function(){i.wait()},error:function(){i.error()}})},setLocation:function(a,n){$(".ui-location ul").html("");var l=e.findParentToArray(a,n);l&&l.length>0&&$(l).each(function(e,a){var n=document.createElement("li");t.isEn?$(n).html(a.labelEN):$(n).html(a.label),$(".ui-location ul").append(n),e!=l.length-1&&$(n).append("<i class='fa fa-angle-right'></i>")})},getStar:function(e){for(var a="",t=1;t<=5;t++)a+=t<=e?"<i class='light fa fa-star'></i>":"<i class='fa fa-star'></i>";return a},loadPage:function(e){menuMapData[mid]?menuMapData[mid]:null},drawChart:function(a){var t={};t.chartContainer=a.chartContainer?a.chartContainer:null,t.chartOption=a.chartOption?a.chartOption:null,t.data=a.data?a.data:null,t.callback=a.callback?a.callback:null,t.draw=function(){t.setOption(),e.highCharts({container:t.chartContainer,chartOption:t.chartOption,callback:t.callback})},t.setOption=function(){t.chartOption.series=t.data},t.draw()},arrayStrToNumber:function(e){var a=[];return $(e).each(function(e,t){a.push(Number(t))}),a},setPanelButtonbar:function(){$(".ui-panel-buttonbar li").on("click",function(){$(this).parent().children("li").removeClass("active"),$(this).addClass("active")})},setGridLinkGroup:function(){$(".ui-grid-linkGroup li").on("click",function(){$(this).parent().children("li").removeClass("active"),$(this).addClass("active")})},mergeTreeData:function(e,a){var e=e;return $(e).each(function(t,n){if(n.id==a)return n.icon="../images/0.png",n.open=!0,!0;var l=!1;$(e).each(function(e,a){if(a.pid==n.id)return n.icon="../images/2.png",n.open=!0,l=!0,!1}),0==l&&(n.icon="../images/4.png")}),e},gridFilter:function(a){var t=$.parseJSON(a);switch(t.code){case"0":null==t.data?(t.recordsTotal=0,t.recordsFiltered=0,t.data=[]):(t.recordsTotal=t.data.totalElements,t.recordsFiltered=t.data.totalElements,t.data=t.data.content);break;default:t.recordsTotal=0,t.recordsFiltered=0,t.data=[];var n=e.requestTip();n.error(t.message)}return JSON.stringify(t)},gridFilters:function(a){var t=$.parseJSON(a);switch(t.code){case"0":null==t.data?(t.recordsTotal=0,t.recordsFiltered=0,t.data=[]):(t.recordsTotal=t.data.length,t.recordsFiltered=t.data.length,t.data=t.data);break;default:t.recordsTotal=0,t.recordsFiltered=0,t.data=[];var n=e.requestTip();n.error(t.message)}return JSON.stringify(t)},gridPageFliter:function(e,t){e.page=e.start/e.length,e.size=t?t:a},getUserSession:function(e){e.setRequestHeader("Test","test")},getParams:function(a,n,l){t.gridPageFliter(a);var r="";r=e.form.getParams($(n),!0);var i=0;for(var o in a){switch(o){case"columns":case"search":case"draw":case"order":case"start":continue;default:r+=0==i&&""==r?o+"="+a[o]:"&"+o+"="+a[o]}i++}return r},getPostParams:function(a,n,l){t.gridPageFliter(a);var r=e.form.getParams($(n));return r&&(a=$.extend(a,r)),JSON.stringify(a)},initButtonbar:function(e){$(e).find(".add").show().removeClass("disabled"),$(e).find(".modify").removeClass("disabled").addClass("disabled"),$(e).find(".delete").removeClass("disabled").addClass("disabled"),$(e).find(".adds").show().removeClass("disabled")},treeTable:function(a){var t={};t.tmpRow=null,t.dg=function(e){e&&e.length>0&&$(e).each(function(e,n){var l=document.createElement("tr");$(l).attr("data-tt-id",n.id),$(l).attr("data-tt-parent-id",n.pid),$(l).addClass("ui-treeTableChild");var r="";$(a.aoColumns).each(function(e,a){var t=a.type?a.type:null;switch(t){case"checkbox":r+="<td><input type='checkbox' class='cb' name='cb' level='"+n.level+"' value='"+n[a.data]+"' pid='"+n.pid+"'/></td>";break;case"operation":var l="";l="4"==n.level?"":"<button rid='"+n[a.data]+"' level='"+n.level+"' class='btn btn-link blue addChild'  title='新增子级'><i class='fa fa-plus'></i></button>",r+="<td><button rid='"+n[a.data]+"' class='btn btn-link blue modify' type='role' name='修改' title='修改'><i class='fa fa-pencil'></i></button><button rid='"+n[a.data]+"' class='btn btn-link blue delete' type='role' name='删除' title='删除'><i class='fa fa-trash-o'></i></button>"+l+"</td>";break;default:r+="<td>"+function(){return n[a.data]?n[a.data]:"--"}()+"</td>"}}),$(l).html(r),$(t.tmpRow).after(l),t.tmpRow=l,t.dg(n.children)})};var n=a.json.data;$(n).each(function(e,n){n.children&&n.children.length>0&&(t.tmpRow=$(a.nTable).find("tbody tr[rootrow='"+e+"']"),t.dg(n.children))}),e.treeTable({container:a.nTable,setting:{expandable:!0}})},typeSelect:function(e){switch(e){case"12":return"文本";case"91":return"日期";case"3":return"数字";case"93":return"时间";case"4":return"整型";case"2004":return"大字段"}},typeSelectText:function(e){switch(e){case"文本":return"12";case"日期":return"91";case"数字":return"3";case"时间":return"93";case"整型":return"4";case"大字段":return"2004"}},getCookies:function(){var e=$.cookie("dssgUserInfo");return e&&(e=JSON.parse(e)),e},selectedTr:function(e){e.find("tbody").on("click","tr",function(){$("tbody tr").removeClass("selected"),$(this).toggleClass("selected")})},disableInput:function(e){$.each(e,function(e,a){$("input[name="+a+"]").attr("disabled","disabled"),$("select[name="+a+"]").attr("disabled","disabled"),$("."+a).attr("disabled","disabled")})},interceptString:function(e,a){var t=a?a:30;return e.length>t?"<div title='"+e+"'>"+(e.substr(0,t)+"...")+"</div>":"<div title='"+e+"'>"+e+"</div>"},getGridOption:function(e){e=e?e:{};var a=0!=e.paging,t=0!=e.processing,n=0!=e.info,l=0!=e.serverSide,r=1==e.searching,i=1==e.ordering,o=1==e.lengthChange;return{processing:t,serverSide:l,searching:r,ordering:i,lengthChange:o,info:n,paging:a,ajax:{url:"../json/grid2.json",type:"get",contentType:"application/json",data:function(e){return common.getParams(e,$("#search-form"))}},columns:[],columnDefs:[],drawCallback:function(e){}}},getStepsHeight:function(){var e=$(".ui-page-item.active .ui-content"),a=e.find(".ui-content-controlbar"),t=e.innerHeight()-a.innerHeight()-90;return t},pull:function(){e.pull({container:$(".ui-aside.left"),target:$(".ui-aside.right"),pullbtn:"../images/pullbtn.png",color:"#333",bg:"#ccc",hoverBg:"#bbb",border:"#666"})},tree:function(a){var n=a.data?a.data:null,l=a.type?a.type:"get",r=a.url?a.url:null,i=a.params?a.params:null,o=a.container?a.container:null,c=a.defaultId?a.defaultId:null,s=0!=a.expandAll,d=null,u=(a.clickEvent?a.clickEvent:null,1==a.checked),b=a.setting?a.setting:{},f=a.dataDef?a.dataDef:"data";b.data={simpleData:{enable:!0}},u&&(b.check={enable:!0});var g=a.callback?a.callback:null,m=a.dataCallback?a.dataCallback:null;return g&&(g.beforeClick=function(e,a,t){$("#myAccordion .curSelectedNode").removeClass("curSelectedNode")},b.callback=g),b.view={fontCss:function(e,a){return a.font?a.font:{}},nameIsHTML:!0},o&&$(o).addClass("ztree"),n?d=e.tree({container:o,setting:b,data:t.mergeTreeData(n[f],"-1"),selectNodeId:c,expandAll:s}):r&&e.ajax({url:r,params:i,type:l,async:!1,success:function(a){if(a.success){if(a.data&&a.data.length>=0){m&&(a=m(a));var n=t.mergeTreeData(a[f],"-1");n||(n=a),d=e.tree({container:o,setting:b,data:n,selectNodeId:c,expandAll:s})}}else t.login()},error:function(){t.login()}}),d?d.treeObj:null},login:function(){window.location.href=$.base+"/login.html"},load:function(a,t){t=t?t:null,a&&e.page.load({url:a,callback:function(){t&&t()}})},back:function(){e.page.back()},apiSourceNameChange:function(e){return"local"==e?"本地数据库":"第三方API"},drawGrid:function(a){var n=a.container,l=a.gridOption,r={},i=a.idDef?a.idDef:"id";if(n&&l){for(var o in l)switch(o){case"drawCallback":r.drawCallback=function(e){t.role(),l.drawCallback(e)};break;default:r[o]=l[o]}return e.datatables({container:$(n),option:r,nodataIcon:"<img src='../images/nodata.png'/>",filter:t.gridFilter,selectType:a.selectType?a.selectType:null,selectAttribute:a.selectAttribute?a.selectAttribute:null,callback:a.callback?a.callback:null,idDef:i})}},setCodeRole:function(e,a){var t=null;switch(a){case 0:break;case 1:t="{en_number:true,required:true,length:1}";break;case 2:t="{en_number:true,required:true,length:2}";break;case 3:t="{en_number:true,required:true,length:3}";break;case 4:t="{en_number:true,required:true,length:3}"}$(e).attr("role",t)},ajax:function(a){e.ajax(a)},role:function(){if(t.hasRole&&scopeMenuData){var e=$(".ui-menubar #mid").val();if(e){for(var a in scopeMenuData){var n=scopeMenuData[a];n.pId!=e&&n.pid!=e||n.label&&$(".ui-page-item:eq(0) .btn[type='role']").filter("[name='"+n.label+"']").attr("role","active")}$(".ui-page-item:eq(0) .btn[type='role']").filter("[role!='active']").remove()}}},getUploadInfo:function(e){switch(e){case"notnode":return"请上传正确格式的接入节点证书";case"notmanage":return"请上传正确格式的管理节点证书";case"uploadfail":return"证书文件上传失败";case"suffixfail":return"文件格式不正确";case"authfail":return"证书文件解析过程中出现异常";case"error":return"证书解析失败,请上传正确证书";case"compressionerror":return"证书压缩包解压失败请核对证书文件，或联系管理员";case"ioerror":return"证书压缩包文件读取失败";case"filereadfail":return"业务文件读取失败...请联系管理员";case"notcername":return"压缩包中证书名称不合法，请联系管理员";default:return"导入失败"}},tab:function(a){var t={};t.container=a.container?a.container:null,t.data=a.data?a.data:null,t.clickEvent=a.clickEvent?a.clickEvent:null,t.cls=a.cls?a.cls:null,t.height=a.height?a.height:40,t.size=a.size?a.size:7,t.container&&t.data&&0!=t.data.length&&e.pillTabs({container:t.container,data:t.data,clickEvent:t.clickEvent,size:t.size,cls:t.cls,itemHeight:t.height})}};return t}),a.fb=e}({},function(){return this}())}();