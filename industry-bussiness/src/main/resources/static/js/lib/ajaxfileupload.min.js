jQuery.extend({createUploadIframe:function(e,t){var r="jUploadFrame"+e;if(window.ActiveXObject){if(jQuery.browser.version=="9.0"||jQuery.browser.version=="10.0"){var a=document.createElement("iframe");a.id=r;a.name=r}else if(jQuery.browser.version=="6.0"||jQuery.browser.version=="7.0"||jQuery.browser.version=="8.0"){var a=document.createElement('<iframe id="'+r+'" name="'+r+'" />');if(typeof t=="boolean"){a.src="javascript:false"}else if(typeof t=="string"){a.src=t}}}else{var a=document.createElement("iframe");a.id=r;a.name=r}a.style.position="absolute";a.style.top="-1000px";a.style.left="-1000px";document.body.appendChild(a);return a},createUploadForm:function(e,t){var r="jUploadForm"+e;var a="jUploadFile"+e;var o=$('<form  action="" method="POST" name="'+r+'" id="'+r+'" enctype="multipart/form-data"></form>');var n=$("#"+t);var u=$(n).clone();$(n).attr("id",a);$(n).before(u);$(n).appendTo(o);$(o).css("position","absolute");$(o).css("top","-1200px");$(o).css("left","-1200px");$(o).appendTo("body");return o},addOtherRequestsToForm:function(e,t){var r=$('<input type="hidden" name="" value="">');for(var a in t){name=a;value=t[a];var o=r.clone();o.attr({name:name,value:value});$(o).appendTo(e)}return e},ajaxFileUpload:function(e){e=jQuery.extend({},jQuery.ajaxSettings,e);var t=(new Date).getTime();var r=jQuery.createUploadForm(t,e.fileElementId);if(e.data)r=jQuery.addOtherRequestsToForm(r,e.data);var a=jQuery.createUploadIframe(t,e.secureuri);var o="jUploadFrame"+t;var n="jUploadForm"+t;if(e.global&&!jQuery.active++){jQuery.event.trigger("ajaxStart")}var u=false;var i={};if(e.global)jQuery.event.trigger("ajaxSend",[i,e]);var c=function(t){var a=document.getElementById(o);try{if(a.contentWindow){i.responseText=a.contentWindow.document.body?a.contentWindow.document.body.innerHTML:null;i.responseXML=a.contentWindow.document.XMLDocument?a.contentWindow.document.XMLDocument:a.contentWindow.document}else if(a.contentDocument){i.responseText=a.contentDocument.document.body?a.contentDocument.document.body.innerHTML:null;i.responseXML=a.contentDocument.document.XMLDocument?a.contentDocument.document.XMLDocument:a.contentDocument.document}}catch(t){jQuery.handleError(e,i,null,t)}if(i||t=="timeout"){u=true;var n;console.log(i);try{n=t!="timeout"?"success":"error";if(n!="error"){var c=jQuery.uploadHttpData(i,e.dataType);if(e.success)e.success(c,n);if(e.global)jQuery.event.trigger("ajaxSuccess",[i,e])}else jQuery.handleError(e,i,n)}catch(t){n="error";jQuery.handleError(e,i,n,t)}if(e.global)jQuery.event.trigger("ajaxComplete",[i,e]);if(e.global&&!--jQuery.active)jQuery.event.trigger("ajaxStop");if(e.complete)e.complete(i,n);jQuery(a).unbind();setTimeout(function(){try{$(a).remove();$(r).remove()}catch(t){jQuery.handleError(e,i,null,t)}},100);i=null}};if(e.timeout>0){setTimeout(function(){if(!u)c("timeout")},e.timeout)}try{var r=$("#"+n);$(r).attr("action",e.url);$(r).attr("method","POST");$(r).attr("target",o);if(r.encoding){r.encoding="multipart/form-data"}else{r.enctype="multipart/form-data"}$(r).submit()}catch(t){jQuery.handleError(e,i,null,t)}if(window.attachEvent){document.getElementById(o).attachEvent("onload",c)}else{document.getElementById(o).addEventListener("load",c,false)}return{abort:function(){}}},uploadHttpData:function(r,type){var data=!type;data=type=="xml"||data?r.responseXML:r.responseText;if(type=="script")jQuery.globalEval(data);if(type=="json"){var data=r.responseText;var rx=new RegExp("<pre.*?>(.*?)</pre>","i");var am=rx.exec(data);var data=am?am[1]:"";eval("data = "+data)}if(type=="html")jQuery("<div>").html(data).evalScripts();return data},handleError:function(e,t,r,a){if(e.error){e.error.call(e.context||e,t,r,a)}if(e.global){(e.context?jQuery(e.context):jQuery.event).trigger("ajaxError",[t,e,a])}}});