!function(g){"use strict";var X="ht",v=g[X],y=v.Default,H=Math,O=(H.PI,H.sin,H.cos,H.atan2,H.sqrt,H.max),T=H.floor,Q=(H.round,H.ceil),d=v.Shape,n=(v.Edge,v.List),z=v.Style,h=v.graph,I=y.getInternal(),m=I.ui(),a=null,G="prototype",u=g.clearInterval,k=g.setInterval,B=function(W){var M=W.data,m=this.dm();if(M&&"add"===W.kind){var Q=m.__dashFlowDatas,p=M instanceof d?"shape.":"edge.";Q&&M.s(p+"dash.flow")&&Q.indexOf(M)<0&&Q.push(M)}"clear"===W.kind&&(m.__dashFlowDatas=[])},Y=function(O){var u=O.property,n=O.data,y=O.newValue,V=this.dm().__dashFlowDatas,g=n instanceof d?"s:shape.dash.flow":"s:edge.dash.flow";if(V&&u===g)if(y)V.indexOf(n)<0&&V.push(n);else for(var Q=V.length,w=0;Q>w;w++)if(V[w]===n){V.splice(w,1);break}},W=h.GraphView[G],P=m.EdgeUI[G],D=m.ShapeUI[G],c=D.drawBody,K=P.drawBody,j=v.DataModel[G],V=j.prepareRemove,q=W.setDataModel;z["edge.dash.flow.step"]==a&&(z["edge.dash.flow.step"]=3),z["shape.dash.flow.step"]==a&&(z["shape.dash.flow.step"]=3),j.prepareRemove=function(s){V.call(this,s);var N=s._dataModel,i=N.__dashFlowDatas;if(i)for(var t=i.length,j=0;t>j;j++)if(i[j]===s){i.splice(j,1);break}},W.setDataModel=function(c){var N=this,P=N._dataModel;if(P!==c){P&&(P.umm(B,N),P.umd(Y,N),P.__dashFlowDatas=[]),c.mm(B,N),c.md(Y,N);var z=c.__dashFlowDatas=[];c.each(function($){var r=$ instanceof d?"shape.":"edge.";$.s(r+"dash.flow")&&z.indexOf($)<0&&z.push($)}),q.call(N,c)}},W.setDashFlowInterval=function(W){var Y=this,p=Y._dashFlowInterval;Y._dashFlowInterval=W,Y.fp("dashFlowInterval",p,W),Y.__dashFlowId!=a&&(u(Y.__dashFlowId),delete Y.__dashFlowId,Y.enableDashFlow(W))},W.getDashFlowInterval=function(){return this._dashFlowInterval},W.drawDashFlow=function(){var j,s,H,m=this,X=m.tx(),e=m.ty(),J=m._zoom,z=m.getWidth(),f=m.getHeight(),E={x:-X/J,y:-e/J,width:z/J,height:f/J},b=m.dm().__dashFlowDatas,g=m._visibleMap,i=new n;if(b.forEach(function(a){g[a.getId()]&&(j=m.getDataUI(a),j&&(H=j.getBounds(),H&&i.add(H)))}),0!==i.size()&&(i.each(function(v){y.intersectsRect(E,v)&&(s=y.unionRect(s,v))}),s&&(s&&(y.grow(s,O(1,1/J)),s.x=T(s.x*J)/J,s.y=T(s.y*J)/J,s.width=Q(s.width*J)/J,s.height=Q(s.height*J)/J,s=y.intersection(E,s)),s))){var K=m._canvas.getContext("2d");K.save(),K.lineCap=y.lineCap,K.lineJoin=y.lineJoin,I.translateAndScale(K,X,e,J),K.beginPath(),K.rect(s.x,s.y,s.width,s.height),K.clip(),K.clearRect(s.x,s.y,s.width,s.height),m.drawDashFlowEdge(K,s),K.restore()}},W.drawDashFlowEdge=function(U,D){var j,T,d=this;d.drawBottomPainters(U),d.each(function(l){d._visibleMap[l._id]&&(j=d.getDataUI(l),j&&(T=j.getBounds(),(!D||y.intersectsRect(D,T))&&(j._drawDashFlow=!0,j.draw(U),delete j._drawDashFlow)))}),d.drawTopPainters(U)},W.enableDashFlow=function(C){var o=this;o.__dashFlowId==a&&(o.__dashFlowId=k(function(){o.drawDashFlow()},C||o._dashFlowInterval||50))},W.disableDashFlow=function(){var J=this;u(J.__dashFlowId),delete J.__dashFlowId};var f=function(){var T=this,f=T._data,V=f instanceof d?"shape.":"edge.",o=f.s(V+"dash.pattern"),H=f.s(V+"dash.flow.reverse");if(o&&f.s(V+"dash")&&f.s(V+"dash.flow")&&T._drawDashFlow){var Y=T.s(V+"dash.offset")||0,$=f.s(V+"dash.flow.step"),a=f.getStyleMap(),t=0;o.forEach(function(s){t+=s}),H&&($=-$),Y-=$,Y%=t,a||(f._styleMap=a={}),a[V+"dash.offset"]=Y}};P.drawBody=function(X){K.call(this,X),f.call(this)},D.drawBody=function(T){c.call(this,T),f.call(this)}}(this,Object);